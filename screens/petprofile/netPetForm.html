<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
<link rel='stylesheet' href='/screens/homeScreen/homepage.css'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<body>

  <!-- navbar start -->
  <nav class="shadow-sm navbar navbar-expand-lg navbar-light bg-white sticky-top">
    <div class="container-fluid">
      <div class='mx-md-2'>
        <img class='hover-zoom' src='../../img/logo.png'  width=80 height=80>
      </div>
      <form class='ms-lg-5'>
        <input class="form-control rounded1 me-2 d-sm-inline d-none" type="search" placeholder="Search" aria-label="Search">
      </form>
      <div class='mx-3 font-monospace'>
          Creating a new pet...
      </div>

      <button class="navbar-toggler mx-1 border-0 hover-color " type="button" data-bs-toggle="collapse"
        data-bs-target="#navbarScroll" aria-controls="navbarSupportedContent" aria-e
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarScroll">
        <ul class="navbar-nav me-auto my-2 my-lg-0 m-lg-auto" style="--bs-scroll-height: 100px;">
          <li id="home" class="nav-item mx-3 hover-color" onclick=fill(this.id)>
            <a class="nav-link active px-3" aria-current="page" href="/screens/homeScreen/homeScreen.html"><img src="/screens/homeScreen/icons/house-fill.svg" alt="Bootstrap"
                width="32" height="32">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Home</span></a>
          </li>
          <li id="chat" class="nav-item mx-3 hover-color" onclick=fill(this.id)>
            <a class="nav-link px-3" href="#"><img src="/screens/homeScreen/icons/chat.svg" alt="Bootstrap" width="32" height="32">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Chat</span></a>
          </li>
          <li id="profile" class="nav-item mx-3 hover-color" onclick=fill(this.id)>
            <a class="nav-link px-3" href="#"><img src="/screens/homeScreen/icons/person.svg" alt="Bootstrap" width="32" height="32">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Profile</span></a>
          </li>
          <li id="map" class="nav-item mx-3 hover-color" onclick=fill(this.id)>
            <a class="nav-link px-3" href="#"><img src="/screens/homeScreen/icons/pin-map.svg" alt="Bootstrap" width="30" height="30">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Nearby
                Pets</span></a>
          </li>
          <li id="settings" class="nav-item mx-3 hover-color" onclick=fill(this.id)>
            <a class="nav-link px-3" href="#"><img src="/screens/homeScreen/icons/gear.svg" alt="Bootstrap" width="32" height="32">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Settings</span></a>
          </li>
          <li id="logout" class="nav-item mx-3 hover-color" onclick=logout()>
            <a class="nav-link px-3" href="#"><img src="/screens/homeScreen/icons/box-arrow-right.svg" alt="Bootstrap" width="32" height="32">
              <span class='d-sm-inline d-md-inline d-lg-none my-auto mx-3 text-dark font-monospace'>Log Out</span></a>
          </li>
        </ul>
      </div>

    </div>
  </nav>
  <!-- navbar end -->
  <div class='container-fluid fadein'>
    <div class='row' >
      <div class='col mt-2' style='text-align: center;color:chocolate;display: none;' id='location-check'>
        Please enable your location services and refresh the page to have the best experience on PetSociety :)
      </div>
    </div>
    <div class='row mx-1'>
        <div class='col-xl-3 col-md-12 col-sm-12 col-xs-12 mt-sm-0 mt-xl-0 ms-sm-0'> 
        </div>
      <!-- sidebar end -->

      <!-- body content start -->
      <div class="col-xl-6 col-md-12 col-sm-12 col-xs-12 body-text ms-sm-0" id='card-list'>
        <div style="max-width:800px;" id="postid-`+postId+`" class="card shadow border border-0 themebg font-monospace rounded2 py-3 px-md-5 px-sm-4 px-3 mt-xl-4 mt-sm-3 mt-3 mx-auto">
            <!-- Who shared the post -->
            <div class="font-monospace fs-6 text-center my-3 fw-bold">Thanks for catalogging a new pet and helping this community grow</div>
            <div class="font-monospace fs-6 text-center my-3">However, please check that this pet has not been already logged by the community and ensure that your location is enabled for us to locate the pet's whereabouts</div>
            <div id='isLocationOn' class="font-monospace fs-6 text-center my-3" style='color:chocolate'>Checking location status...</div>
            <div id='petFormInputs' style='display:none;'>
                <input id='input-name' class="form-control rounded mw-50 mb-3" placeholder="Give the pet a name :)"  required>
                <input id='input-breed' class="form-control rounded mw-50 mb-3" placeholder="Breed"  required>
                <input id='input-gender' class="form-control rounded mw-50 mb-3" placeholder="Gender"  required>
                <div class="input-group">
                    <button type="button" class="btn btn-secondary rounded2 mb-1"> <label id='uploadImageLabel' for="file">Upload an Image</label></button> 
                    <input type="file" class="button button-secondary m-2" style="display:none" id="file"
                      accept="image/png, image/jpeg, image/heic" name="file" multiple onchange="loadImageDisplay(event)">
                </div>
                <div class='ml-3'>
                    <img id="output" class="card-img-top rounded2 shadow" style='max-height:500px; object-fit:cover'>  
                 </div>
                <button class='btn btn-primary rounded2 mb-1' onclick="createPetProfile()">Register Pet</button>

            </div>
            <div>
            </div>
          </div>
      </div>
      <!-- Chat sidebar -->
      <div class='col-md-3 mt-3 d-xl-inline d-none' id='chatSidebar'>
    </div>
  </div>
  </div>
  


</body>
<!-- JavaScript Bundle with Popper -->
<script src="homepage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src='https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js'></script>
<script src='https://www.gstatic.com/firebasejs/7.7.0/firebase-storage.js'></script>
<!-- firebase api -->
<script src='/firebase-API/createPost.js'></script>
<script src='/firebase-API/connector.js'></script>
<!-- vuejs -->
<script src="https://unpkg.com/vue@next"></script>

<script>
  
  // test()

  // get user location
  currentLocation = "no location"

  function success(position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;
    currentLocation = { latitude: latitude, longitude: longitude }
  }

  function error() {
    console.log(currentLocation)
  }

  if (!navigator.geolocation) {
    alert('Geolocation is not supported by your browser');
  } else {
    navigator.geolocation.getCurrentPosition(success, error);
  }

  // console.log(currentLocation)
  
  function createPost() {
    const file = document.getElementById("file").files[0]
    createNewPost()
  }

  // cardList = document.getElementById('card-list')

  
// cardList.innerHTML = newCardHTML+newCardHTML

  myStorage = window.sessionStorage;
  if (myStorage.userID===undefined){
        console.log("Not login")
        // console.log(myStorage)
        myStorage.redirect = 'fromLoginNoAccount'
        window.location.href = "/screens/welcomeScreen/login.html"; 
    }else{
        console.log("Login")
        // console.log(myStorage)
        user_id = myStorage.userID
        // console.log(user_id)
    }


  function checkIfUserOnLocation() {         //  create a loop function
    setTimeout(function() {   
      console.log(currentLocation)
      if(currentLocation == "no location"){
        // console.log("SDASDSAasdsadsadas")
        document.getElementById('isLocationOn').innerText='Please enable your location and refresh this page'

      }else{
        // console.log("SDASDSA")
        document.getElementById('isLocationOn').innerText='User location detected thank you'
        document.getElementById('petFormInputs').style.display='block'
      }
    }, 2000)

    setTimeout(function() {   
      console.log(currentLocation)
      if(currentLocation == "no location"){
        document.getElementById('isLocationOn').innerText='Please enable your location and refresh this page'

      }else{
        document.getElementById('isLocationOn').innerText='User location detected thank you'
        document.getElementById('petFormInputs').style.display='block'
      }
    }, 5000)
  }
  checkIfUserOnLocation()

  const queryString = window.location.search;

  function loadImageDisplay(event){
  var image = document.getElementById('output');
	image.src = URL.createObjectURL(event.target.files[0]);
  document.getElementById('uploadImageLabel').innerText = 'Change image'
    }   
  console.log(queryString);
</script>

</html>